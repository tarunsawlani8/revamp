<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
      <link rel="shortcut icon" href="favicon.ico"  type="image/x-icon"/>

    <title>Amar Opticals | Eyeglasses, Sunglasses & Contact Lenses</title>

    <!-- Bootstrap core CSS -->
    <link href="../../dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="../../dist/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="theme.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="../../assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
      <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="../../resources/demos/style.css">
    
  
  </head>

  <body ng-app="mainApp">

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="home.html">AMAR OPTICALS.IN</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li ><a href="#/getMessageBalance">Home</a></li>
           <li class="dropdown">
            
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Invoice<span class="caret"></span></a>
              <ul class="dropdown-menu">
                      <li><a href="#/createInvoice">Add Invoice</a></li>
                <li><a href="#/viewInvoice">View Invoice</a></li>
                
              </ul>
            
            </li>
             <li class="dropdown">
            
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Stocks<span class="caret"></span></a>
              <ul class="dropdown-menu">
                      <li><a href="#/addStock">Add Stock</a></li>
                <li><a href="#/updateStock">Update Stock</a></li>
                
              </ul>
            
            </li>
             <li class="dropdown">
            
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tasks<span class="caret"></span></a>
              <ul class="dropdown-menu">
                      <li><a href="#/searchTask">Search Task</a></li>
                
              </ul>
            
            </li>
            
            <li class="active" style="align:right;"><a href="#about">Hello</a></li>
			<li ><a  href="home.html" style="align:right;">Logout</a></li>
     
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
	<div ng-view></div>
	
    
    <!-- /container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
       <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.9/angular.min.js"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.9/angular-route.min.js"></script>
    <script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.12.0.js"></script>
    
          <script type="text/javascript" src="js/app.js"></script>
     <script type="text/javascript" src="js/InvoiceController.js"></script>
  
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../../dist/js/bootstrap.min.js"></script>
    <script src="../../assets/js/docs.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
   

	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

	<script>
	  var mainApp = angular.module("mainApp", ['ngRoute','ui.bootstrap']);
      mainApp.config(['$routeProvider', function($routeProvider) {
         $routeProvider.
         
         when('/createInvoice', {
            templateUrl: 'createInvoice.html',
            controller: 'AddInvoiceController'
         }).
         when('/viewInvoice', {
             templateUrl: 'viewInvoice.html',
             controller: 'ViewInvoiceController'
          }).
         
         when('/addStock', {
             templateUrl: 'addStock.html',
             controller: 'AddStockController'
          }).
          when('/updateStock', {
              templateUrl: 'updateStock.html',
              controller: 'UpdateStockController'
           }).
           when('/searchTask', {
               templateUrl: 'searchTask.html',
               controller: 'TaskController'
            }).
            when('/getMessageBalance', {
                templateUrl: 'messageBalance.html',
                controller: 'MessageController'
             }).
   
           
           otherwise({
            redirectTo: '/getMessageBalance'
         });
      }]);
      
 	</script>
      
    <script>  
      mainApp.controller('AddInvoiceController', function($scope, $http) {
         $scope.withoutDetailsInvoice = false;
         $scope.invoiceModel = {
  	            name: null,
  	            contact: null,
  	            cmail: null,
  	            totalAmount: 0,
  	            pendingAmount: null,
  	            initialAmount: null,
  	            referredBy : null,
  	            deliveryDate : null,
  	            purchaseItems: []
  	        };
         
         
         $scope.productTypes = [];
         
         $http({method : "GET",
    		   url :"/stocks/getStocksType", 
    		 
    		   headers : {
    			'Content-Type' : 'application/json'   
    		   }
    		   }
    		   ).success(function (response) {
    				 
    		
    			 // if (response.statusMessage == 'success') {
    			   $scope.productTypes = response;
    			   $scope.productTypes.push("LENS");
    			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
    			//   $('#successMsg').show();
    			 //  } 
    			   
    		   }).error(function(error, status){
    			  
    				//   $('#errorMsg').show();
    		   });
         
    
         
         
         $scope.showLensStock = false;
         $scope.loadStocksByType = function(type) {
        	 
        	 if ("LENS" == type) {
        		 
        		 
        		 $scope.showLensStock = true;
        		 return;
        	 }
        	 
        	 $scope.showLensStock = false;
        	 
        	 
         $http({method : "GET",
  		   url :"/stocks/getStocksbyType/"+type, 
  		 
  		   headers : {
  			'Content-Type' : 'application/json'   
  		   }
  		   }
  		   ).success(function (response) {
  				 
  		
  			 // if (response.statusMessage == 'success') {
  			   $scope.stocks = response;
  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
  			//   $('#successMsg').show();
  			 //  } 
  			   
  		   }).error(function(error, status){
  			  
  				//   $('#errorMsg').show();
  		   });
         };
         
         $scope.stocks= [
    	 ];
     
         
         $scope.invoiceModel.purchaseItems = [];
         
         
         $scope.pushToTemp = function(ind) {
        	 
        	 if ($scope.invoiceModel.purchaseItems.indexOf(ind) !==-1) {
        		 
        		 var index = $scope.invoiceModel.purchaseItems.indexOf(ind);
        		 var xx = $scope.invoiceModel.purchaseItems[index].buyQuantity;
        		 $scope.invoiceModel.purchaseItems[index].buyQuantity = parseInt(xx)+1;

        	return;
        	 } 
        	 
     		$scope.invoiceModel.purchaseItems.push(ind);

     	};
     	
     	
     	
     	$scope.calculateCost = function(x) {
     		
     		
     		x.totalCost = x.buyQuantity * x.unitPrice;
     	//	console.log(x.totalCost);
     	};
     	
    //	
    	$scope.calculateTotalAmount = function() {
    		$scope.invoiceModel.totalAmount = 0;	
    	     angular.forEach($scope.invoiceModel.purchaseItems, function(item) {
    	    	 $scope.invoiceModel.totalAmount= $scope.invoiceModel.totalAmount+ item.totalCost;   
    	    	});
    		return $scope.invoiceModel.totalAmount;
    	//	console.log("cal"+x.totalCost);
    	//	console.log("total Amount"+$scope.totalAmount);
     	
     	//	console.log("total Amount"+$scope.totalAmount);
     	};
     	
$scope.calculatePendingAmount = function(initialAmount) {
	//console.log("total Amount"+$scope.initialAmount);
	
 	$scope.invoiceModel.pendingAmount= 0;
		if (!isNaN(initialAmount)) {
		
			
    		if ($scope.invoiceModel.totalAmount <parseInt(initialAmount)) { 	
    			alert("Initial Amount annot be greater than Total Amount");
     	} 
    		
    	return 	$scope.invoiceModel.pendingAmount= parseInt($scope.invoiceModel.totalAmount) - parseInt(initialAmount);

    		
    		
		}};
		
		$scope.lensRecordExists= false;
		
		$scope.lensModel = {"lensActive": true,
				"leftEye": [],
				"rightEye": []
		};
		
		$scope.pushToList = function(purchaseModel) 
		{	
			$scope.invoiceModel.purchaseItems.push(purchaseModel);
			$scope.lensRecordExists= true;
			$scope.lensModel = {"lensActive": true,
					"leftEye": [],
					"rightEye": []
			};
		};
		
		$scope.deleteItem = function(index) {
			$scope.invoiceModel.purchaseItems.splice(index, 1);
		};
		
		$scope.isDisabled = false;
		
		$scope.backToHome= function() {
			
			$http.get("/#/createInvoice");
		};
		
$scope.createInvoice = function(invoiceModel) {
			
			$http({method : "POST",
		  		   url :"/invoices/createInvoice",
		  		   data : invoiceModel,
		  		 
		  		   headers : {
		  			'Content-Type' : 'application/json'   
		  		   }
		  		   }
		  		   ).success(function (response) {
		  				 
		  		
		  			 if (response.status == 'success') {
		  			//   $scope.stocks = response;
		  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
		  			//   $('#successMsg').show();
		  			
		  			$scope.isDisabled = true;
		  			$scope.invoiceModel = response.response;
		  			  } 
		  			   
		  		   }).error(function(error, status){
		  			  
		  				//   $('#errorMsg').show();
		  		   });
		};
		
		
		   

      
     	  $scope.clear = function () {
     	    $scope.invoiceModel.deliveryDate = null;
     	  };

     	
     	  $scope.toggleMin = function() {
     	    $scope.minDate = $scope.minDate ? null : new Date();
     	  };
     	  $scope.toggleMin();
 
 
 $scope.datePicker = {
		 opened:false
		}
 
     	  $scope.open = function($event, elementOpened) {
     		
     	    $event.preventDefault();
     	    $event.stopPropagation();
     	    
     	    
     	   $scope.datePicker.opened = true;
     	    
     
     	  };

     	  $scope.dateOptions = {
     	    formatYear: 'yy',
     	    startingDay: 1
     	  };

     
 
      });
      
      
     
 
      
      mainApp.controller('UpdateStockController', function($scope, $http) {
    	   $scope.productTypes = [];
           
           $http({method : "GET",
      		   url :"/stocks/getStocksType", 
      		 
      		   headers : {
      			'Content-Type' : 'application/json'   
      		   }
      		   }
      		   ).success(function (response) {
      				 
      		
      			 // if (response.statusMessage == 'success') {
      			   $scope.productTypes = response;

      			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
      			//   $('#successMsg').show();
      			 //  } 
      			   
      		   }).error(function(error, status){
      			  
      				//   $('#errorMsg').show();
      		   });
           
      
           
    	  
    	  
         $scope.isDisabled = false;
         
         $scope.stockModel = {};
         
         $scope.loadStocksByType = function(type) {
        	 
         $http({method : "GET",
  		   url :"/stocks/getStocksbyType/"+type, 
  		 
  		   headers : {
  			'Content-Type' : 'application/json'   
  		   }
  		   }
  		   ).success(function (response) {
  				 
  		
  			 // if (response.statusMessage == 'success') {
  			   $scope.stocks = response;
  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
  			//   $('#successMsg').show();
  			 //  } 
  			   
  		   }).error(function(error, status){
  			  
  				//   $('#errorMsg').show();
  		   });
         };
         
         $scope.stockModel= {};
         $scope.pushToEdit = function(model) {
        	 $scope.stockModel=model;
         };
         
         $scope.updateStock = function(stockModel) {
        	 $http({method : "POST",
		  		   url :"/stocks/updateStocks",
		  		   data : stockModel,
		  		 
		  		   headers : {
		  			'Content-Type' : 'application/json'   
		  		   }
		  		   }
		  		   ).success(function (response) {
		  				 
		  			 if (response.status == 'success') {
		  			//   $scope.stocks = response;
		  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
		  			//   $('#successMsg').show();
		  			
		  			$scope.isDisabled = true;
		  			$scope.stockModel = response.model;
		  			  } 
		  			   
		  		   }).error(function(error, status){
		  			  
		  				//   $('#errorMsg').show();
		  		   });
        	 
        	 
         }
      });
      
      mainApp.controller('AddStockController', function($scope, $http) {
          $scope.isDisabled = false;
          
          $scope.stockModel = {};
          
          $scope.addStock = function(stockModel) {
         	 $http({method : "POST",
 		  		   url :"/stocks/addStocks",
 		  		   data : stockModel,
 		  		 
 		  		   headers : {
 		  			'Content-Type' : 'application/json'   
 		  		   }
 		  		   }
 		  		   ).success(function (response) {
 		  				 
 		  			 if (response.status == 'success') {
 		  			//   $scope.stocks = response;
 		  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
 		  			//   $('#successMsg').show();
 		  			
 		  			$scope.isDisabled = true;
 		  			$scope.stockModel = response.model;
 		  			  } 
 		  			   
 		  		   }).error(function(error, status){
 		  			  
 		  				//   $('#errorMsg').show();
 		  		   });
         	 
         	 
          }
       });
      
      
      mainApp.controller('TaskController', function($scope, $http) {
          $scope.isDisabled = false;
          
          $scope.taskModel = {};
          
          $scope.taskStatusList = ['IN PROGRESS', 'READY FOR PICKUP', 'DELIVERED'];
          
       
          $scope.pushToEdit = function(model) {
         	 $scope.taskModel=model;
          };
          
          $scope.taskList = [];
          $scope.searchTask = function(taskModel) {
        	  
         	 $http({method : "POST",
 		  		   url :"/tasks/searchTasks",
 		  		   data : taskModel,
 		  		 
 		  		   headers : {
 		  			'Content-Type' : 'application/json'   
 		  		   }
 		  		   }
 		  		   ).success(function (response) {
 		  				 
 		  			// if (response.status == 'success') {
 		  			//   $scope.stocks = response;
 		  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
 		  			//   $('#successMsg').show();
 		  			
 		  		
 		  			$scope.taskList = response;
 		  		 $scope.taskModel = {};
 		  			//  } 
 		  			   
 		  		   }).error(function(error, status){
 		  			  
 		  				//   $('#errorMsg').show();
 		  		   });
         	 
         	 
          };
          
          $scope.updateTask = function(taskModel) {
        	  
          	 $http({method : "POST",
  		  		   url :"/tasks/updateTasks",
  		  		   data : taskModel,
  		  		 
  		  		   headers : {
  		  			'Content-Type' : 'application/json'   
  		  		   }
  		  		   }
  		  		   ).success(function (response) {
  		  				 
  		  			 if (response.status == 'SUCCESS') {
  		  			//   $scope.stocks = response;
  		  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
  		  			//   $('#successMsg').show();
  		  			
  		  			$scope.isDisabled = true;
  		  	  		  $scope.taskList = [];
  		  		
  		  			  } 
  		  			   
  		  		   }).error(function(error, status){
  		  			  
  		  				//   $('#errorMsg').show();
  		  		   });
          	 
          	 
           };
           
           
           $scope.taskModel.deliveryDate = null;
         
        	  $scope.clear = function () {
        	    $scope.taskModel.deliveryDate = null;
        	  };

        	
        	  $scope.toggleMin = function() {
        	    $scope.minDate = $scope.minDate ? null : new Date();
        	  };
        	  $scope.toggleMin();

        	  $scope.open = function($event) {
        	    $event.preventDefault();
        	    $event.stopPropagation();
        	    
        	    if ($scope.isDisabled) {
        	    	   $scope.opened = false;
        	    	   return;
        	    	
        	    }
				
        	    $scope.opened = true;
        	  };

        	  $scope.dateOptions = {
        	    formatYear: 'yy',
        	    startingDay: 1
        	  };

        	  $scope.format = 'yyyy-MM-dd';
        	
       });
      
      mainApp.controller('MessageController', function($scope, $http) {
    	  
    	  $scope.balanceResponse ={};
    	  
    	    $http({method : "GET",
     		   url :"https://www.fast2sms.com/dev/wallet?authorization=4cuqXLQCY3ePfnk7tpz5vsG2DoNiBMhFI0RdZKrwSA98bxOWyE4mZQ1iXFxpAY6wDKegnzjIUyW8J9st", 
     		 
     		   headers : {
     			'Content-Type' : 'application/json'   
     		   }
     		   }
     		   ).success(function (response) {
     				 
     		
     			  $scope.balanceResponse = response.wallet;
     			   
     		   }).error(function(error, status){
     			  
     				//   $('#errorMsg').show();
     		   });

    	  
    	  
      });
      
 mainApp.controller('ViewInvoiceController', ['$scope', '$modal', '$log', '$http',

	    function ($scope, $modal, $log, $http) {
	 
	 
	 $scope.invoiceList = [];
	 
	 $scope.getInvoicesByMonth = function(mmyy) {
   	  
      	 $http({method : "GET",
		  		   url :"/invoices/getInvoicesByMonth/"+mmyy,
		  		   headers : {
		  			'Content-Type' : 'application/json'   
		  		   }
		  		   }
		  		   ).success(function (response) {
		  				 
		  			
		  			//   $scope.stocks = response;
		  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
		  			//   $('#successMsg').show();
		  				 $scope.invoiceList = response;
		  		
		  		
		  			   
		  		   }).error(function(error, status){
		  			  
		  				//   $('#errorMsg').show();
		  		   });
      	 
      	 
       };

	        $scope.viewDetails = function (invoiceId, size) {
	            $scope.invoiceModel = {}
	            
	            $http({method : "GET",
			  		   url :"/invoices/getInvoice/"+invoiceId,
			  		   headers : {
			  			'Content-Type' : 'application/json'   
			  		   }
			  		   }
			  		   ).success(function (response) {
			  				 
			  			
			  			//   $scope.stocks = response;
			  			//   $('#successMsg').text("Number of orders found:"+ response.orders.length);
			  			//   $('#successMsg').show();
			  				 $scope.invoiceModel = response;
			  		
			  		
			  			   
			  		   }).error(function(error, status){
			  			  
			  				//   $('#errorMsg').show();
			  		   });

	            var modalInstance = $modal.open({
	                templateUrl: 'viewInvoiceDetails.html',
	                controller: ModalInstanceCtrl,
	                size : size,
	                scope: $scope,
	                resolve: {
	                    userForm: function () {
	                        return $scope.userForm;
	                    }
	                }
	            });

	            modalInstance.result.then(function (selectedItem) {
	                $scope.selected = selectedItem;
	            }, function () {
	                $log.info('Modal dismissed at: ' + new Date());
	            });
	        };
	            }]);
 

 var ModalInstanceCtrl = function ($scope, $modalInstance, userForm) {
  
     $scope.submitForm = function () {
         if ($scope.form.userForm.$valid) {
             console.log('user form is in scope');
             $modalInstance.close('closed');
         } else {
             console.log('userform is not in scope');
         }
     };

     $scope.cancel = function () {
         $modalInstance.dismiss('cancel');
     };
 };
      
</script>
<script type="text/javascript">
	$(document).ready(function() {
		$('#successMsg').hide();
		$('#errorMsg').hide();
		$('#addOrderBtn').click(function() {
			var formdata = $("#addOrderForm").serialize();
			jQuery.ajax({
				url : "recordController",
				type : "POST",
				data : formdata,
				success : function(data) {

					$('#successMsg').html(data);
					$('#successMsg').show();
					$('#errorMsg').hide();
					 $("#addOrderForm").trigger("reset");
					
				},
				error : function(data){
				$('#errorMsg').show();
				$('#successMsg').hide();
				}
			});
		});
		

	});
	

	
	 $( function() {
		    $( "#deliveryDate" ).datepicker({ dateFormat: 'dd-mm-yy' });
		  } );


	
	
</script>

  </body>
</html>
